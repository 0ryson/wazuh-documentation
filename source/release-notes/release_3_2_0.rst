.. _release_3_2_0:

3.2.0 Release Notes
===================

This section shows the most relevant new features of Wazuh v3.2.0. You will find more detailed information in our `changelog <https://github.com/wazuh/wazuh/blob/3.2/CHANGELOG.md>`_ file.

**New features:**

- `Vulnerability detector module`_
- `AWS CloudTrail module`_
- `CIS-CAT integration now supports Windows OS`_
- `Cluster: Ruleset synchronization and performance improvements`_

Vulnerability detector module
-----------------------------

A native vulnerability detector has been developed. This way, Wazuh is able to analyze and report vulnerabilities without dependencies on external tools.

This vulnerability detector doesn't mean an increase in the use of CPU in the agents, since the agents only collect and send the manager all the necessary information. It's the manager the one that processes all this incoming data to compare it with different vulnerabilities repositories.

Below is an example of results where a vulnerability is identified:

.. code-block:: console
	:emphasize-lines: 3

	** Alert 1518102634.685428: - vulnerability-detector,
	2018 Feb 08 16:10:34 (PC) ->vulnerability-detector
	Rule: 23504 (level 7) -> 'CVE-2017-7226 on Ubuntu 16.04 LTS (xenial) - medium.'
	vulnerability.cve: CVE-2017-7226
	vulnerability.title: CVE-2017-7226 on Ubuntu 16.04 LTS (xenial) - medium.
	vulnerability.severity: Medium
	vulnerability.published: 2017-03-22
	vulnerability.updated: 2017-03-22
	vulnerability.reference: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2017-7226
	vulnerability.rationale: The pe_ILF_object_p function in the Binary File Descriptor (BFD) library (aka libbfd), as distributed in GNU Binutils 2.28, is vulnerable to a heap-based buffer over-read of size 4049 because it uses the strlen function instead of strnlen, leading to program crashes in several utilities such as addr2line, size, and strings. It could lead to information disclosure as well.
	vulnerability.state: Unfixed
	vulnerability.affected_package: binutils
	vulnerability.version: 2.26.1-1ubuntu1~16.04.6

You can read more about this new module in the :doc:`Vulnerability detector section <../user-manual/capabilities/vulnerability-detector>`.

AWS CloudTrail module
---------------------

This module provides the ability to read your `AWS CloudTrail` logs directly from your AWS S3 bucket. Amazon CloudTrail support is built-in Wazuh, giving you the ability to search, analyze, and alert on AWS CloudTrail log data.

Below is an example of the JSON alert generated by this module:

.. code-block:: console
	:emphasize-lines: 3

	** Alert 1518488581.32874246: - amazon,authentication_success,pci_dss_10.2.5,
	2018 Feb 13 02:23:01 manager->Wazuh-AWS
	Rule: 80253 (level 3) -> 'Amazon: signin.amazonaws.com - ConsoleLogin - User Login Success.'
	aws.eventVersion: 1.05
	aws.eventID: 2fb29f0f-4d7f-4384-8170-xxxx
	aws.eventTime: 2018-02-13T02:12:26Z
	aws.log_file: 1661xxx_CloudTrail_us-east-1_20180xxx_S4Wouyxxx.json.gz
	aws.additionalEventData.MFAUsed: No
	aws.additionalEventData.LoginTo: https://console.aws.amazon.com/console/home?state=hashArgs%23&isauthcode=true
	aws.additionalEventData.MobileVersion: No
	aws.eventType: AwsConsoleSignIn
	aws.responseElements.ConsoleLogin: Success
	aws.awsRegion: us-east-1
	aws.eventName: ConsoleLogin
	aws.userIdentity.userName: wazuh
	aws.userIdentity.type: IAMUser
	aws.userIdentity.arn: arn:aws:iam::166157441623:user/wazuh
	aws.userIdentity.principalId: AIDAJxxx
	aws.userIdentity.accountId: 1661xx4xxx
	aws.eventSource: signin.amazonaws.com
	aws.userAgent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/64.0.3282.140 Safari/537.36
	aws.sourceIPAddress: 67.161.xx.xx
	aws.recipientAccountId: 166157441623
	integration: aws

You can read more about this new module in the :doc:`AWS CloudTrail section <../amazon/index>`.

CIS-CAT integration now supports Windows OS
-------------------------------------------

In the latest Wazuh release, the CIS-CAT module was focused only on Linux systems. Now, it also supports Windows systems.

CIS-CAT alerts have been also enriched and reports are parsed natively now, improving it efficiency considerably.

Cluster: Ruleset synchronization and performance improvements
-------------------------------------------------------------

Several bugs have been fixed in the cluster. Also, its general performance has been improved.

The cluster is now able to synchronize user decoders, rules and CDB lists. Before sending any of those files, ``ossec-logtest`` is run to check that new rules, decoders or CDB lists are correctly defined. If the check fails, the synchronization of `only` those files is cancelled. When a client received any decoder, rule or CDB list, it also runs ``ossec-logtest``. If the check is successful, the client is automatically restarted.

The full list of files synchronized by the cluster is:

	- /etc/client.keys
	- /etc/shared
	- /etc/decoders*
	- /etc/rules*
	- /etc/lists*
	- /queue/agent-groups
	- /queue/agent-info

(*) A client node in the cluster will be restarted after receiving this file.
