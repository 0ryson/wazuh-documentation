.. _reference_ossec_rules:


ruleset
=======

.. topic:: XML section name

	.. code-block:: xml

		<ruleset>

Configuration options for enabling or disabling rules and decoders.

Options
-------

- `rule_include`_
- `rule_dir`_
- `rule_exclude`_
- `decoder_include`_
- `decoder_dir`_
- `decoder_exclude`_
- `list`_



rule_include
^^^^^^^^^^^^^

Load a single rule file.

+--------------------+-----------------------------------+
| **Default Value**  | n/a                               |
+--------------------+-----------------------------------+
| **Allowed values** | Path and filename of rule to load |
+--------------------+-----------------------------------+

Example:

.. code-block:: xml

	  <rule_include>ruleset/rules/my_rules.xml</rule_include>



rule_dir
^^^^^^^^

Load a directory of rules. The files will be loaded in alphabetical order and any duplicate filenames will be skipped.

+--------------------+------------------------------------+
| **Default Value**  | ruleset/rules                      |
+--------------------+------------------------------------+
| **Allowed values** | Path to a directory of rule files. |
+--------------------+------------------------------------+

.. topic:: Attributes

	An optional pattern can be included in the opening tag. The pattern is a regex match string used to determine if a file should be loaded.

Example:

.. code-block:: xml

      <rule_dir pattern="_rules.xml$">ruleset/rules</rule_dir>


rule_exclude
^^^^^^^^^^^^^

Exclude a single rule file.

+--------------------+--------------------------------------+
| **Default Value**  | n/a                                  |
+--------------------+--------------------------------------+
| **Allowed values** | Path and filename of rule to exclude |
+--------------------+--------------------------------------+

Example:

.. code-block:: xml

	  <rule_exclude>0215-policy_rules.xml</rule_exclude>


decoder_include
^^^^^^^^^^^^^^^^^

Load a single decoder file.

+--------------------+--------------------------------------+
| **Default Value**  | n/a                                  |
+--------------------+--------------------------------------+
| **Allowed values** | Path and filename of decoder to load |
+--------------------+--------------------------------------+

Example:

.. code-block:: xml

    <decoder_include>ruleset/decoders/my_decoder.xml</decoder_include>


decoder_dir
^^^^^^^^^^^^^^

Load a directory of decoders. The files will be loaded in alphabetical order and any duplicate filenames will be skipped.

+--------------------+--------------------------------------+
| **Default Value**  | ruleset/decoders                     |
+--------------------+--------------------------------------+
| **Allowed values** | Path to a directory of decoder files |
+--------------------+--------------------------------------+

.. topic:: Attributes

  An optional pattern can be included in the opening tag. The pattern is a regex match string used to determine if a file should be loaded.

Example:

.. code-block:: xml

      <decoder_dir pattern=".xml$">ruleset/decoders</decoder_dir>


decoder_exclude
^^^^^^^^^^^^^^^^^

Exclude a single decoder file.

+--------------------+-----------------------------------------+
| **Default Value**  | n/a                                     |
+--------------------+-----------------------------------------+
| **Allowed values** | Path and filename of decoder to exclude |
+--------------------+-----------------------------------------+

Example:

.. code-block:: xml

    <decoder_exclude>ruleset/decoders/my_decoder.xml</decoder_exclude>

list
^^^^^^^

Load a single CDB reference for use by other rules.

+--------------------+------------------------------------------------+
| **Default Value**  | n/a                                            |
+--------------------+------------------------------------------------+
| **Allowed values** | Path to a list file to be loaded and compiled. |
+--------------------+------------------------------------------------+

Example:

.. code-block:: xml

    <list>etc/lists/blocked_hosts</list>

.. note::

    Do not include the file extension.  Wazuh will read the .cdb version of the file (the version generated by ossec-makelists from the .txt version of the file.
