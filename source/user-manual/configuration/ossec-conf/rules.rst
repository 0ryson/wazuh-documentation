.. _reference_ossec_rules:


Ruleset
=======

.. topic:: XML section name

	.. code-block:: xml

		<ruleset>

Configuration options for enabling or disabling rules and decoders.

+----------------+------------------------------------------------+
| Options        | Allowed values                                 |
+================+================================================+
| `include`_     | Path and filename of rule to load              |
+----------------+------------------------------------------------+
| `rule`_        | Path and filename of rule to load              |
+----------------+------------------------------------------------+
| `rule_dir`_    | Path to a directory of rule files              |
+----------------+------------------------------------------------+
| `decoder`_     | Path and filename of decoder to load           |
+----------------+------------------------------------------------+
| `decoder_dir`_ | Path to a directory of decoder files           |
+----------------+------------------------------------------------+
| `list`_        | Path to a list file to be loaded and compiled. |
+----------------+------------------------------------------------+

``include``
-----------

Load a single rule file.

.. topic:: Default value

	n/a

.. topic:: Allowed values

	Path and filename of rule to load. Example: rules/config.xml


``rule``
--------

Load a single rule file.

.. note::

    This works the same as ``include`` but was created to mirror the syntax in other sections of the rules config.

.. topic:: Default value

	n/a

.. topic:: Allowed values

	Path and filename of rule to load. Example: rules/config.xml

``rule_dir``
------------

Load a directory of rules. The files will be loaded in alphabetical order and any duplicate filenames will be skipped. 

.. topic:: Default value

	.. code-block:: xml

		<rule_dir>ruleset/rules</rule_dir>

.. topic:: Allowed values

	Path to a directory of rule files.

.. topic:: Attributes

	An optional pattern can be included in the opening tag.  Example:  <rule_dir pattern="ruleset.xml">rules</rule_dir> The pattern is a regex match string used to determine if a file should be loaded.


``decoder``
-----------


Load a single decoder file. The path should refer to the installation directory, typically ``/var/ossec``.

.. note::

	If no decoders are specified in ossec.conf, the legacy ``etc/decoder.xml`` and
	``etc/local_decoder.xml`` are loaded.

.. warning::

	If ``<decoder>`` or ``<decoder_dir>`` are used, the default decoder.xml will not be used and must be specifically referenced in order to load.

.. topic:: Default value

	n/a

.. topic:: Allowed values

	Path and filename of decoder to load example: rules/decoder/decoder.xml

``decoder_dir``
---------------

Load a directory of decoders. The files will be loaded in alphabetical order and any duplicate filenames will be skipped.  The path should refer to the installation directory, typically ``/var/ossec``.

.. warning::

    If ``<decoder>`` or ``<decoder_dir>`` are used, the default decoder.xml will not be used. It must be specified explicitly.

.. topic:: Default value

	.. code-block:: xml

		<decoder_dir>ruleset/decoders</decoder_dir>

.. topic:: Allowed values

	Path to a directory of decoder files

.. topic:: Attributes

  An optional pattern can be included in the opening tag.  Example:  <decoder_dir pattern="-decoder.xml">ruleset/decoders</decoder_dir> The pattern is a regex match string used to determine if a file should be loaded.

``list``
--------

Load a single CDB reference for use by other rules.

.. note::

    Do not include the file extension.  Wazuh will read the .cdb version of the file (the version generated by ossec-makelists from the .txt version of the file. 


.. topic:: Default value

	n/a

.. topic:: Allowed values

	Path to a list file to be loaded and compiled.

	.. code-block:: xml

		<rules>
		  <list>rules/lists/blocked_hosts</list>
		</rules>
